{
	"name": "F_BILLING_DF",
	"properties": {
		"folder": {
			"name": "SAPECCDataFlows"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "VBRP",
						"type": "DatasetReference"
					},
					"name": "VBRP"
				},
				{
					"dataset": {
						"referenceName": "VBRK",
						"type": "DatasetReference"
					},
					"name": "VBRK"
				},
				{
					"dataset": {
						"referenceName": "VBAP",
						"type": "DatasetReference"
					},
					"name": "VBAP"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "F_Billing",
						"type": "DatasetReference"
					},
					"name": "FSink"
				}
			],
			"transformations": [
				{
					"name": "RequiredColumns"
				},
				{
					"name": "TrimingFunction"
				},
				{
					"name": "SO"
				},
				{
					"name": "SelectedColumns"
				},
				{
					"name": "BillingCKey"
				},
				{
					"name": "BillingSKey"
				}
			],
			"script": "source(output(\n\t\tMANDT as string,\n\t\tVBELN as string,\n\t\tPOSNR as decimal(6,0),\n\t\tUEPOS as decimal(6,0),\n\t\tFKIMG as decimal(13,3),\n\t\tVRKME as string,\n\t\tUMVKZ as decimal(5,0),\n\t\tUMVKN as decimal(5,0),\n\t\tMEINS as string,\n\t\tSMENG as decimal(13,3),\n\t\tFKLMG as decimal(13,3),\n\t\tLMENG as decimal(13,3),\n\t\tNTGEW as decimal(15,3),\n\t\tBRGEW as decimal(15,3),\n\t\tGEWEI as string,\n\t\tVOLUM as decimal(15,3),\n\t\tVOLEH as string,\n\t\tGSBER as string,\n\t\tPRSDT as date,\n\t\tFBUDA as date,\n\t\tKURSK as decimal(9,5),\n\t\tNETWR as decimal(15,2),\n\t\tVBELV as string,\n\t\tPOSNV as decimal(6,0),\n\t\tVGBEL as string,\n\t\tVGPOS as decimal(6,0),\n\t\tVGTYP as string,\n\t\tAUBEL as string,\n\t\tAUPOS as decimal(6,0),\n\t\tAUREF as string,\n\t\tMATNR as string,\n\t\tARKTX as string,\n\t\tPMATN as string,\n\t\tCHARG as string,\n\t\tMATKL as string,\n\t\tPSTYV as string,\n\t\tPOSAR as string,\n\t\tPRODH as string,\n\t\tVSTEL as string,\n\t\tATPKZ as string,\n\t\tSPART as string,\n\t\tPOSPA as decimal(6,0),\n\t\tWERKS as string,\n\t\tALAND as string,\n\t\tWKREG as string,\n\t\tWKCOU as string,\n\t\tWKCTY as string,\n\t\tTAXM1 as string,\n\t\tTAXM2 as string,\n\t\tTAXM3 as string,\n\t\tTAXM4 as string,\n\t\tTAXM5 as string,\n\t\tTAXM6 as string,\n\t\tTAXM7 as string,\n\t\tTAXM8 as string,\n\t\tTAXM9 as string,\n\t\tKOWRR as string,\n\t\tPRSFD as string,\n\t\tSKTOF as string,\n\t\tSKFBP as decimal(13,2),\n\t\tKONDM as string,\n\t\tKTGRM as string,\n\t\tKOSTL as string,\n\t\tBONUS as string,\n\t\tPROVG as string,\n\t\tEANNR as string,\n\t\tVKGRP as string,\n\t\tVKBUR as string,\n\t\tSPARA as string,\n\t\tSHKZG as string,\n\t\tERNAM as string,\n\t\tERDAT as date,\n\t\tERZET as string,\n\t\tBWTAR as string,\n\t\tLGORT as string,\n\t\tSTAFO as string,\n\t\tWAVWR as decimal(13,2),\n\t\tKZWI1 as decimal(13,2),\n\t\tKZWI2 as decimal(13,2),\n\t\tKZWI3 as decimal(13,2),\n\t\tKZWI4 as decimal(13,2),\n\t\tKZWI5 as decimal(13,2),\n\t\tKZWI6 as decimal(13,2),\n\t\tSTCUR as decimal(9,5),\n\t\tUVPRS as string,\n\t\tUVALL as string,\n\t\tEAN11 as string,\n\t\tPRCTR as string,\n\t\tKVGR1 as string,\n\t\tKVGR2 as string,\n\t\tKVGR3 as string,\n\t\tKVGR4 as string,\n\t\tKVGR5 as string,\n\t\tMVGR1 as string,\n\t\tMVGR2 as string,\n\t\tMVGR3 as string,\n\t\tMVGR4 as string,\n\t\tMVGR5 as string,\n\t\tMATWA as string,\n\t\tBONBA as decimal(13,2),\n\t\tKOKRS as string,\n\t\tPAOBJNR as decimal(10,0),\n\t\tPS_PSP_PNR as decimal(8,0),\n\t\tAUFNR as string,\n\t\tTXJCD as string,\n\t\tCMPRE as decimal(11,2),\n\t\tCMPNT as string,\n\t\tCUOBJ as decimal(18,0),\n\t\tCUOBJ_CH as decimal(18,0),\n\t\tKOUPD as string,\n\t\tUECHA as decimal(6,0),\n\t\tXCHAR as string,\n\t\tABRVW as string,\n\t\tSERNR as string,\n\t\tBZIRK_AUFT as string,\n\t\tKDGRP_AUFT as string,\n\t\tKONDA_AUFT as string,\n\t\tLLAND_AUFT as string,\n\t\tMPROK as string,\n\t\tPLTYP_AUFT as string,\n\t\tREGIO_AUFT as string,\n\t\tVKORG_AUFT as string,\n\t\tVTWEG_AUFT as string,\n\t\tABRBG as date,\n\t\tPROSA as string,\n\t\tUEPVW as string,\n\t\tAUTYP as string,\n\t\tSTADAT as date,\n\t\tFPLNR as string,\n\t\tFPLTR as decimal(6,0),\n\t\tAKTNR as string,\n\t\tKNUMA_PI as string,\n\t\tKNUMA_AG as string,\n\t\tPREFE as string,\n\t\tMWSBP as decimal(13,2),\n\t\tAUGRU_AUFT as string,\n\t\tFAREG as string,\n\t\tUPMAT as string,\n\t\tUKONM as string,\n\t\tCMPRE_FLT as double,\n\t\tABFOR as string,\n\t\tABGES as double,\n\t\tJ_1ARFZ as string,\n\t\tJ_1AREGIO as string,\n\t\tJ_1AGICD as string,\n\t\tJ_1ADTYP as string,\n\t\tJ_1ATXREL as string,\n\t\tJ_1BCFOP as string,\n\t\tJ_1BTAXLW1 as string,\n\t\tJ_1BTAXLW2 as string,\n\t\tJ_1BTXSDC as string,\n\t\tBRTWR as decimal(15,2),\n\t\tWKTNR as string,\n\t\tWKTPS as decimal(6,0),\n\t\tRPLNR as string,\n\t\tKURSK_DAT as date,\n\t\tWGRU1 as string,\n\t\tWGRU2 as string,\n\t\tKDKG1 as string,\n\t\tKDKG2 as string,\n\t\tKDKG3 as string,\n\t\tKDKG4 as string,\n\t\tKDKG5 as string,\n\t\tVKAUS as string,\n\t\tJ_1AINDXP as string,\n\t\tJ_1AIDATEP as date,\n\t\tKZFME as string,\n\t\tMWSKZ as string,\n\t\tVERTT as string,\n\t\tVERTN as string,\n\t\tSGTXT as string,\n\t\tDELCO as string,\n\t\tBEMOT as string,\n\t\tRRREL as string,\n\t\tAKKUR as decimal(9,5),\n\t\tWMINR as string,\n\t\tVGBEL_EX as string,\n\t\tVGPOS_EX as decimal(6,0),\n\t\tLOGSYS as string,\n\t\tVGTYP_EX as string,\n\t\tJ_1BTAXLW3 as string,\n\t\tJ_1BTAXLW4 as string,\n\t\tJ_1BTAXLW5 as string,\n\t\tMSR_ID as string,\n\t\tMSR_REFUND_CODE as string,\n\t\tMSR_RET_REASON as string,\n\t\tNRAB_KNUMH as string,\n\t\tNRAB_VALUE as decimal(13,2),\n\t\tDISPUTE_CASE as string,\n\t\tFUND_USAGE_ITEM as string,\n\t\tFARR_RELTYPE as string,\n\t\tCLAIMS_TAXATION as string,\n\t\tKURRF_DAT_ORIG as date,\n\t\tVGTYP_EXT as string,\n\t\tSGT_RCAT as string,\n\t\tSGT_SCAT as string,\n\t\tAUFPL as decimal(10,0),\n\t\tAPLZL as decimal(8,0),\n\t\tDPCNR as string,\n\t\tDCPNR as decimal(3,0),\n\t\tDPNRB as decimal(3,0),\n\t\tPEROP_BEG as date,\n\t\tPEROP_END as date,\n\t\tFONDS as string,\n\t\tFISTL as string,\n\t\tFKBER as string,\n\t\tGRANT_NBR as string,\n\t\tPRS_WORK_PERIOD as decimal(7,0),\n\t\tPPRCTR as string,\n\t\tPARGB as string,\n\t\tAUFPL_OAA as decimal(10,0),\n\t\tAPLZL_OAA as decimal(8,0),\n\t\tCAMPAIGN as string,\n\t\tCOMPREAS as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> VBRP\nsource(output(\n\t\tMANDT as string,\n\t\tVBELN as string,\n\t\tFKART as string,\n\t\tFKTYP as string,\n\t\tVBTYP as string,\n\t\tWAERK as string,\n\t\tVKORG as string,\n\t\tVTWEG as string,\n\t\tKALSM as string,\n\t\tKNUMV as string,\n\t\tVSBED as string,\n\t\tFKDAT as date,\n\t\tBELNR as string,\n\t\tGJAHR as decimal(4,0),\n\t\tPOPER as decimal(3,0),\n\t\tKONDA as string,\n\t\tKDGRP as string,\n\t\tBZIRK as string,\n\t\tPLTYP as string,\n\t\tINCO1 as string,\n\t\tINCO2 as string,\n\t\tEXPKZ as string,\n\t\tRFBSK as string,\n\t\tMRNKZ as string,\n\t\tKURRF as decimal(9,5),\n\t\tCPKUR as string,\n\t\tVALTG as decimal(2,0),\n\t\tVALDT as date,\n\t\tZTERM as string,\n\t\tZLSCH as string,\n\t\tKTGRD as string,\n\t\tLAND1 as string,\n\t\tREGIO as string,\n\t\tCOUNC as string,\n\t\tCITYC as string,\n\t\tBUKRS as string,\n\t\tTAXK1 as string,\n\t\tTAXK2 as string,\n\t\tTAXK3 as string,\n\t\tTAXK4 as string,\n\t\tTAXK5 as string,\n\t\tTAXK6 as string,\n\t\tTAXK7 as string,\n\t\tTAXK8 as string,\n\t\tTAXK9 as string,\n\t\tNETWR as decimal(15,2),\n\t\tZUKRI as string,\n\t\tERNAM as string,\n\t\tERZET as string,\n\t\tERDAT as date,\n\t\tSTAFO as string,\n\t\tKUNRG as string,\n\t\tKUNAG as string,\n\t\tMABER as string,\n\t\tSTWAE as string,\n\t\tEXNUM as string,\n\t\tSTCEG as string,\n\t\tAEDAT as date,\n\t\tSFAKN as string,\n\t\tKNUMA as string,\n\t\tFKART_RL as string,\n\t\tFKDAT_RL as date,\n\t\tKURST as string,\n\t\tMSCHL as string,\n\t\tMANSP as string,\n\t\tSPART as string,\n\t\tKKBER as string,\n\t\tKNKLI as string,\n\t\tCMWAE as string,\n\t\tCMKUF as decimal(9,5),\n\t\tHITYP_PR as string,\n\t\tBSTNK_VF as string,\n\t\tVBUND as string,\n\t\tFKART_AB as string,\n\t\tKAPPL as string,\n\t\tLANDTX as string,\n\t\tSTCEG_H as string,\n\t\tSTCEG_L as string,\n\t\tXBLNR as string,\n\t\tZUONR as string,\n\t\tMWSBK as decimal(13,2),\n\t\tLOGSYS as string,\n\t\tFKSTO as string,\n\t\tXEGDR as string,\n\t\tRPLNR as string,\n\t\tLCNUM as string,\n\t\tJ_1AFITP as string,\n\t\tKURRF_DAT as date,\n\t\tAKWAE as string,\n\t\tAKKUR as decimal(9,5),\n\t\tKIDNO as string,\n\t\tBVTYP as string,\n\t\tNUMPG as decimal(3,0),\n\t\tBUPLA as string,\n\t\tVKONT as string,\n\t\tFKK_DOCSTAT as string,\n\t\tNRZAS as string,\n\t\tSPE_BILLING_IND as string,\n\t\tVTREF as string,\n\t\tFK_SOURCE_SYS as string,\n\t\tFKTYP_CRM as string,\n\t\tSTGRD as string,\n\t\tVBTYP_EXT as string,\n\t\tDPC_REL as string,\n\t\tMNDID as string,\n\t\tPAY_TYPE as string,\n\t\tSEPON as string,\n\t\tMNDVG as string,\n\t\tSPPAYM as string,\n\t\tSPPORD as string,\n\t\tSUBDT as date,\n\t\tCRPNO as string,\n\t\tCRPDT as date,\n\t\tZNO as string,\n\t\tZREF as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> VBRK\nsource(output(\n\t\tMANDT as string,\n\t\tVBELN as string,\n\t\tPOSNR as decimal(6,0),\n\t\tMATNR as string,\n\t\tMATWA as string,\n\t\tPMATN as string,\n\t\tCHARG as string,\n\t\tMATKL as string,\n\t\tARKTX as string,\n\t\tPSTYV as string,\n\t\tPOSAR as string,\n\t\tLFREL as string,\n\t\tFKREL as string,\n\t\tUEPOS as decimal(6,0),\n\t\tGRPOS as decimal(6,0),\n\t\tABGRU as string,\n\t\tPRODH as string,\n\t\tZWERT as decimal(13,2),\n\t\tZMENG as decimal(13,3),\n\t\tZIEME as string,\n\t\tUMZIZ as decimal(5,0),\n\t\tUMZIN as decimal(5,0),\n\t\tMEINS as string,\n\t\tSMENG as decimal(13,3),\n\t\tABLFZ as decimal(13,3),\n\t\tABDAT as date,\n\t\tABSFZ as decimal(13,3),\n\t\tPOSEX as string,\n\t\tKDMAT as string,\n\t\tKBVER as decimal(3,0),\n\t\tKEVER as decimal(3,0),\n\t\tVKGRU as string,\n\t\tVKAUS as string,\n\t\tGRKOR as decimal(3,0),\n\t\tFMENG as string,\n\t\tUEBTK as string,\n\t\tUEBTO as decimal(3,1),\n\t\tUNTTO as decimal(3,1),\n\t\tFAKSP as string,\n\t\tATPKZ as string,\n\t\tRKFKF as string,\n\t\tSPART as string,\n\t\tGSBER as string,\n\t\tNETWR as decimal(15,2),\n\t\tWAERK as string,\n\t\tANTLF as decimal(1,0),\n\t\tKZTLF as string,\n\t\tCHSPL as string,\n\t\tKWMENG as decimal(15,3),\n\t\tLSMENG as decimal(15,3),\n\t\tKBMENG as decimal(15,3),\n\t\tKLMENG as decimal(15,3),\n\t\tVRKME as string,\n\t\tUMVKZ as decimal(5,0),\n\t\tUMVKN as decimal(5,0),\n\t\tBRGEW as decimal(15,3),\n\t\tNTGEW as decimal(15,3),\n\t\tGEWEI as string,\n\t\tVOLUM as decimal(15,3),\n\t\tVOLEH as string,\n\t\tVBELV as string,\n\t\tPOSNV as decimal(6,0),\n\t\tVGBEL as string,\n\t\tVGPOS as decimal(6,0),\n\t\tVOREF as string,\n\t\tUPFLU as string,\n\t\tERLRE as string,\n\t\tLPRIO as decimal(2,0),\n\t\tWERKS as string,\n\t\tLGORT as string,\n\t\tVSTEL as string,\n\t\tROUTE as string,\n\t\tSTKEY as string,\n\t\tSTDAT as date,\n\t\tSTLNR as string,\n\t\tSTPOS as decimal(5,0),\n\t\tAWAHR as decimal(3,0),\n\t\tERDAT as date,\n\t\tERNAM as string,\n\t\tERZET as string,\n\t\tTAXM1 as string,\n\t\tTAXM2 as string,\n\t\tTAXM3 as string,\n\t\tTAXM4 as string,\n\t\tTAXM5 as string,\n\t\tTAXM6 as string,\n\t\tTAXM7 as string,\n\t\tTAXM8 as string,\n\t\tTAXM9 as string,\n\t\tVBEAF as decimal(5,2),\n\t\tVBEAV as decimal(5,2),\n\t\tVGREF as string,\n\t\tNETPR as decimal(11,2),\n\t\tKPEIN as decimal(5,0),\n\t\tKMEIN as string,\n\t\tSHKZG as string,\n\t\tSKTOF as string,\n\t\tMTVFP as string,\n\t\tSUMBD as string,\n\t\tKONDM as string,\n\t\tKTGRM as string,\n\t\tBONUS as string,\n\t\tPROVG as string,\n\t\tEANNR as string,\n\t\tPRSOK as string,\n\t\tBWTAR as string,\n\t\tBWTEX as string,\n\t\tXCHPF as string,\n\t\tXCHAR as string,\n\t\tLFMNG as decimal(13,3),\n\t\tSTAFO as string,\n\t\tWAVWR as decimal(13,2),\n\t\tKZWI1 as decimal(13,2),\n\t\tKZWI2 as decimal(13,2),\n\t\tKZWI3 as decimal(13,2),\n\t\tKZWI4 as decimal(13,2),\n\t\tKZWI5 as decimal(13,2),\n\t\tKZWI6 as decimal(13,2),\n\t\tSTCUR as decimal(9,5),\n\t\tAEDAT as date,\n\t\tEAN11 as string,\n\t\tFIXMG as string,\n\t\tPRCTR as string,\n\t\tMVGR1 as string,\n\t\tMVGR2 as string,\n\t\tMVGR3 as string,\n\t\tMVGR4 as string,\n\t\tMVGR5 as string,\n\t\tKMPMG as decimal(13,3),\n\t\tSUGRD as string,\n\t\tSOBKZ as string,\n\t\tVPZUO as string,\n\t\tPAOBJNR as decimal(10,0),\n\t\tPS_PSP_PNR as decimal(8,0),\n\t\tAUFNR as string,\n\t\tVPMAT as string,\n\t\tVPWRK as string,\n\t\tPRBME as string,\n\t\tUMREF as double,\n\t\tKNTTP as string,\n\t\tKZVBR as string,\n\t\tSERNR as string,\n\t\tOBJNR as string,\n\t\tABGRS as string,\n\t\tBEDAE as string,\n\t\tCMPRE as decimal(11,2),\n\t\tCMTFG as string,\n\t\tCMPNT as string,\n\t\tCMKUA as decimal(9,5),\n\t\tCUOBJ as decimal(18,0),\n\t\tCUOBJ_CH as decimal(18,0),\n\t\tCEPOK as string,\n\t\tKOUPD as string,\n\t\tSERAIL as string,\n\t\tANZSN as integer,\n\t\tNACHL as string,\n\t\tMAGRV as string,\n\t\tMPROK as string,\n\t\tVGTYP as string,\n\t\tPROSA as string,\n\t\tUEPVW as string,\n\t\tKALNR as decimal(12,0),\n\t\tKLVAR as string,\n\t\tSPOSN as string,\n\t\tKOWRR as string,\n\t\tSTADAT as date,\n\t\tEXART as string,\n\t\tPREFE as string,\n\t\tKNUMH as string,\n\t\tCLINT as decimal(10,0),\n\t\tCHMVS as decimal(3,0),\n\t\tSTLTY as string,\n\t\tSTLKN as decimal(8,0),\n\t\tSTPOZ as decimal(8,0),\n\t\tSTMAN as string,\n\t\tZSCHL_K as string,\n\t\tKALSM_K as string,\n\t\tKALVAR as string,\n\t\tKOSCH as string,\n\t\tUPMAT as string,\n\t\tUKONM as string,\n\t\tMFRGR as string,\n\t\tPLAVO as string,\n\t\tKANNR as string,\n\t\tCMPRE_FLT as double,\n\t\tABFOR as string,\n\t\tABGES as double,\n\t\tJ_1BCFOP as string,\n\t\tJ_1BTAXLW1 as string,\n\t\tJ_1BTAXLW2 as string,\n\t\tJ_1BTXSDC as string,\n\t\tWKTNR as string,\n\t\tWKTPS as decimal(6,0),\n\t\tSKOPF as string,\n\t\tKZBWS as string,\n\t\tWGRU1 as string,\n\t\tWGRU2 as string,\n\t\tKNUMA_PI as string,\n\t\tKNUMA_AG as string,\n\t\tKZFME as string,\n\t\tLSTANR as string,\n\t\tTECHS as string,\n\t\tMWSBP as decimal(13,2),\n\t\tBERID as string,\n\t\tPCTRF as string,\n\t\tLOGSYS_EXT as string,\n\t\tJ_1BTAXLW3 as string,\n\t\tJ_1BTAXLW4 as string,\n\t\tJ_1BTAXLW5 as string,\n\t\tSTOCKLOC as string,\n\t\tSLOCTYPE as string,\n\t\tMSR_RET_REASON as string,\n\t\tMSR_REFUND_CODE as string,\n\t\tMSR_APPROV_BLOCK as string,\n\t\tNRAB_KNUMH as string,\n\t\tTRMRISK_RELEVANT as string,\n\t\tSGT_RCAT as string,\n\t\tHANDOVERLOC as string,\n\t\tHANDOVERDATE as date,\n\t\tHANDOVERTIME as string,\n\t\tTC_AUT_DET as string,\n\t\tMANUAL_TC_REASON as string,\n\t\tFISCAL_INCENTIVE as string,\n\t\tTAX_SUBJECT_ST as string,\n\t\tFISCAL_INCENTIVE_ID as string,\n\t\tSPCSTO as decimal(2,0),\n\t\tREVACC_REFID as string,\n\t\tREVACC_REFTYPE as string,\n\t\tSESSION_CREATION_DATE as date,\n\t\tSESSION_CREATION_TIME as string,\n\t\t{/BEV1/SRFUND} as string,\n\t\tAUFPL_OLC as decimal(10,0),\n\t\tAPLZL_OLC as decimal(8,0),\n\t\tFERC_IND as string,\n\t\tKOSTL as string,\n\t\tFONDS as string,\n\t\tFISTL as string,\n\t\tFKBER as string,\n\t\tGRANT_NBR as string,\n\t\tIUID_RELEVANT as string,\n\t\tPRS_OBJNR as string,\n\t\tPRS_SD_SPSNR as decimal(8,0),\n\t\tPRS_WORK_PERIOD as decimal(7,0),\n\t\tPARGB as string,\n\t\tAUFPL_OAA as decimal(10,0),\n\t\tAPLZL_OAA as decimal(8,0),\n\t\tPERNR as decimal(8,0),\n\t\tENAME as string,\n\t\tNAT as string,\n\t\tNAME as string,\n\t\tNORHRS as string,\n\t\tNIGHRS as string,\n\t\tHOLHRS as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> VBAP\nTrimingFunction select(mapColumn(\n\t\t{Billing No} = VBRP@VBELN,\n\t\t{Billing Ln} = POSNR,\n\t\t{Billing Qty} = FKIMG,\n\t\t{Billing Gross Value} = BRTWR,\n\t\t{Billing Net Value} = VBRP@NETWR,\n\t\t{Billing Exchange Rate} = KURSK,\n\t\t{Billing Service Render Date} = FBUDA,\n\t\t{Billing Rebate Basis} = BONBA,\n\t\t{Billing Promotion} = AKTNR,\n\t\t{Billing Cash Disc Val} = SKFBP,\n\t\t{Billing Tax Val Doc Curr} = MWSBP,\n\t\t{Billing Type} = FKART,\n\t\t{Billing Category} = FKTYP,\n\t\t{Billing Currency} = WAERK,\n\t\t{Billing Created Date} = VBRP@ERDAT,\n\t\t{Billing Changed Date} = AEDAT,\n\t\t{Billing Date} = FKDAT,\n\t\t{Billing Cancellation Status} = FKSTO,\n\t\t{Billing Export Ind} = EXPKZ,\n\t\t{Billing Payment Terms} = ZTERM\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: true) ~> RequiredColumns\nVBRP, VBRK join(ltrim(VBRP@VBELN,'0') == ltrim(VBRK@VBELN, '0'),\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> TrimingFunction\nRequiredColumns, VBAP join(ltrim({Billing No},'0') == ltrim(VBELN,'0')\n\t&& {Billing Ln} == POSNR,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> SO\nSO select(mapColumn(\n\t\t{Billing No},\n\t\t{Billing Ln},\n\t\t{Billing Type},\n\t\t{Billing Category},\n\t\t{Billing Qty},\n\t\t{Billing Gross Value},\n\t\t{Billing Net Value},\n\t\t{Billing Currency},\n\t\t{Billing Exchange Rate},\n\t\t{Billing Tax Val Doc Curr},\n\t\t{Billing Created Date},\n\t\t{Billing Changed Date},\n\t\t{Billing Date},\n\t\t{Billing Service Render Date},\n\t\t{Billing Rebate Basis},\n\t\t{Billing Promotion},\n\t\t{Billing Cash Disc Val},\n\t\t{Billing Cancellation Status},\n\t\t{Billing Export Ind},\n\t\t{Billing Payment Terms},\n\t\tERDAT = {VBAP@ERDAT}\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: true) ~> SelectedColumns\nSelectedColumns derive({Billing Cancellation Status} = iif(toBoolean({Billing Cancellation Status}),'x','No'),\n\t\t{Billing CKey} = ltrim(concat({Billing No}, toString({Billing Ln}, '####')),'0'),\n\t\t{Billing No} = ltrim({Billing No}, '0')) ~> BillingCKey\nBillingCKey keyGenerate(output({Billing SKey} as long),\n\tstartAt: 1L) ~> BillingSKey\nBillingSKey sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\trecreate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> FSink"
		}
	}
}